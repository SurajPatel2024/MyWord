
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MY WORD</title>
<style>
  /* Base Styles */
  body { font-family: sans-serif; background: #f4f4f4; padding: 20px; margin: 0; }
  .container { 
    background: #fff; 
    max-width: 900px; 
    margin: auto; 
    padding: 20px; 
    border-radius: 8px; 
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    box-sizing: border-box; /* Crucial for width calculation */
  }
  
  h2 { text-align: center; }
  .controls { text-align: center; margin-bottom: 20px; }
  
  /* Table Styles */
  table { 
    width: 100%; 
    border-collapse: collapse; 
    table-layout: auto; /* Allows columns to adjust to content */
    border: 2px solid #000;
  }
  
  th, td { 
    border: 1px solid #000; 
    padding: 8px; 
    text-align: left; 
    word-wrap: break-word; /* Prevents text from pushing columns out */
  }
  
  th { background: #eee; }
  .sno-col { width: 50px; text-align: center; }

  /* Buttons */
  button { padding: 6px 12px; margin: 3px; cursor: pointer; }
  .print-btn { background: #28a745; color: white; border: none; font-weight: bold; }

  /* PRINT FIXES - THIS SOLVES THE CUT-OFF PROBLEM */
  @media print {
    @page {
      size: auto;
      margin: 15mm; /* Standard margin for printers */
    }
    body { background: white; padding: 0; }
    .controls { display: none !important; }
    
    .container { 
      width: 100% !important; 
      max-width: 100% !important; 
      margin: 0 !important; 
      padding: 0 !important; 
      box-shadow: none !important;
    }

    table { 
      width: 100% !important; 
      border: 1px solid black !important;
      /* Helps the browser fit the table to the paper width */
      overflow: visible !important;
    }

    th, td { 
      font-size: 10pt; /* Smaller text ensures it fits on paper */
      border: 1px solid black !important;
    }
  }
</style>
</head>
<body>

<div class="container">
  <h2 contenteditable="true">Editable Document</h2>

  <div class="controls">
    <button onclick="addRow()">‚ûï Row</button>
    <button onclick="deleteRow()">‚ûñ Row</button>
    <button onclick="addColumn()">‚ûï Column</button>
    <button onclick="deleteColumn()">‚ûñ Column</button>
    <button onclick="autoRenumber()">üî¢ Reset S.No</button>
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Now</button>
  </div>

  <table id="mainTable">
    <thead>
      <tr id="headerRow">
        <th class="sno-col" contenteditable="true">S.No</th>
        <th contenteditable="true">Header A</th>
        <th contenteditable="true">Header B</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <tr>
        <td class="sno-col" contenteditable="true">1</td>
        <td contenteditable="true">Data 1</td>
        <td contenteditable="true">Data 2</td>
      </tr>
    </tbody>
  </table>
</div>

<script>
const tableBody = document.getElementById('tableBody');
const headerRow = document.getElementById('headerRow');

function addRow() {
  const colCount = headerRow.cells.length;
  const newRow = document.createElement('tr');
  const nextNum = tableBody.rows.length + 1;

  for (let i = 0; i < colCount; i++) {
    const newCell = document.createElement('td');
    newCell.contentEditable = true;
    if (i === 0) {
      newCell.className = 'sno-col';
      newCell.innerText = nextNum;
    }
    newRow.appendChild(newCell);
  }
  tableBody.appendChild(newRow);
}

function deleteRow() {
  if (tableBody.rows.length > 0) tableBody.deleteRow(-1);
}

function addColumn() {
  const th = document.createElement('th');
  th.contentEditable = true;
  th.innerText = "New Head";
  headerRow.appendChild(th);

  Array.from(tableBody.rows).forEach(row => {
    const td = document.createElement('td');
    td.contentEditable = true;
    row.appendChild(td);
  });
}

function deleteColumn() {
  if (headerRow.cells.length > 1) {
    headerRow.deleteCell(-1);
    Array.from(tableBody.rows).forEach(row => row.deleteCell(-1));
  }
}

function autoRenumber() {
  Array.from(tableBody.rows).forEach((row, index) => {
    row.cells[0].innerText = index + 1;
  });
}
</script>

</body>
</html>
